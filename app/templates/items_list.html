{% extends "base.html" %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/items_list.module.css') }}">
{% endblock %}

{% block content %}
<div class="page-header">
    <h2>Catalogue des Jeux Vid√©o</h2>
    <p>{{ total_items }} jeux dans notre catalogue</p>
</div>

<!-- Barre de recherche et filtres -->
<div class="search-filter-section">
    <form method="GET" action="{{ url_for('items_list') }}" class="search-form">
        <!-- Recherche textuelle -->
        <div class="search-box">
            <input 
                type="text" 
                name="q" 
                placeholder="üîç Rechercher un jeu, d√©veloppeur..." 
                value="{{ current_search }}"
                class="search-input"
            >
            <button type="submit" class="btn btn-primary search-btn">Rechercher</button>
        </div>
        
        <!-- Filtres -->
        <div class="filters-row">
            <!-- Filtre par genre -->
            <div class="filter-group">
                <label for="genre">Genre</label>
                <select name="genre" id="genre" class="filter-select" onchange="this.form.submit()">
                    <option value="">Tous les genres</option>
                    {% for genre in genres %}
                    <option value="{{ genre }}" {% if current_genre == genre %}selected{% endif %}>{{ genre }}</option>
                    {% endfor %}
                </select>
            </div>
            
            <!-- Filtre par ann√©e -->
            <div class="filter-group">
                <label for="year">Ann√©e</label>
                <select name="year" id="year" class="filter-select" onchange="this.form.submit()">
                    <option value="">Toutes les ann√©es</option>
                    {% for year in years %}
                    <option value="{{ year }}" {% if current_year == year|string %}selected{% endif %}>{{ year }}</option>
                    {% endfor %}
                </select>
            </div>
            
            <!-- Filtre par plateforme -->
            <div class="filter-group">
                <label for="platform">Plateforme</label>
                <select name="platform" id="platform" class="filter-select" onchange="this.form.submit()">
                    <option value="">Toutes les plateformes</option>
                    {% for value, label in platforms %}
                    <option value="{{ value }}" {% if current_platform == value %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
            </div>
            
            <!-- Bouton r√©initialiser -->
            <div class="filter-actions">
                <a href="{{ url_for('items_list') }}" class="btn btn-outline">R√©initialiser</a>
            </div>
        </div>
    </form>
</div>

<!-- R√©sultats -->
<div class="results-info">
    {% if current_search or current_genre or current_year or current_platform %}
    <p class="results-count">
        <strong>{{ items|length }}</strong> r√©sultat(s) trouv√©(s)
        {% if current_search %} pour "<em>{{ current_search }}</em>"{% endif %}
    </p>
    {% endif %}
</div>

{% if items|length == 0 %}
<div class="no-results">
    <div class="no-results-icon">üéÆ</div>
    <h3>Aucun jeu trouv√©</h3>
    <p>Essayez de modifier vos crit√®res de recherche ou <a href="{{ url_for('items_list') }}">r√©initialisez les filtres</a>.</p>
</div>
{% else %}
<div class="items-grid">
    {% for item in items %}
    <div class="item-card">
        {% if item.images %}
        <div class="item-card-image">
            <img src="{{ item.images[0] }}" alt="{{ item.title }}" loading="lazy">
        </div>
        {% endif %}
        <div class="item-card-header">
            <span class="item-genre">{{ item.genre }}</span>
        </div>
        <div class="item-card-body">
            <h3>{{ item.title }}</h3>
            <p class="item-developer">{{ item.developer }} ({{ item.year }})</p>
            <p class="item-platform">üì± {{ item.platform }}</p>
            <p class="item-description">{{ item.description[:100] }}...</p>
        </div>
        <div class="item-card-footer">
            <a href="{{ url_for('item_detail', item_id=item.id) }}" class="btn btn-primary">Voir d√©tails</a>
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}
{% endblock %}
